<!--넘어오는 data : foodImgList, foodVideoList / activityImgList, activityVideoList-->
<!--이미지와 비디오 조건 어떻게 나누지
조건에 따라 <img> 추가하거나 <video> 추가하면 될듯-->
<!DOCTYPE html>
<html>
    <head>
        <link rel='stylesheet' href='/css/main.css' /> 
        <script>
            function Timer(ad_ID, user_ID) { 
                console.log("======Timer 함수 내=======");
                console.log(ad_ID, user_ID);
                setTimeout(callAPI(),5000, ad_ID, user_ID); 
            } 

            function callAPI(ad_ID, user_ID) {
                console.log("======callAPI함수 내=======");
                console.log(ad_ID);
                console.log(user_ID);
                console.log("call success");
                $.ajax({
                    url: '/adDB',
                    dataType: 'json',
                    type: 'POST',
                    data: {
                        'ad_id': ad_ID,
                        'user_id': user_ID
                    },
                    success: function(response) {
                        consol.log('adDB 통신 success');
                    }
                });
            }
            // //화면 전환
            // function Timer() { 
            //     setTimeout("locateKap()",25000); 
            // } 

          
            //     } else {
            //         // 시간이 남았을 경우 카운트다운을 지속한다.
            //         document.all.count_text.innerHTML = cnt + "초후에 힐링 화면으로 이동합니다..";
            //         setTimeout("countdown()",1000);
            //         cnt--;
            //     }
            // } 
        </script>
    </head> 
    <body>
        <h2 class="hidden"><%= userID %></h2>
        <script>const user_ID = document.querySelector('h2').innerText;</script>
        <div class="bg">
            <% if (adData.src.indexOf('.jpg') != -1) { %>
                <img src="<%= adData.src %>"/>
                <h1 class="hidden"><%= adData.id %></h1>
                
                <script>
                    // const bgSrcTag = document.querySelector('.bg img[src]').getAttribute('src');
                    const ad_ID = document.querySelector('.bg h1').innerText;
                    // console.log(bgTag);
                    // console.log(ad_ID);
                    // console.log(user_ID);
                    // callAPI(bgTag, ad_ID);
                    Timer(ad_ID, user_ID);
                </script>
            <% }else if (adData.src.indexOf('.mp4') != -1) { %>
                <video muted autoplay loop>
                    <source src="<%= adData.src %>" type="video/mp4">
                </video>
                <h1 class="hidden"><%= adData.id %></h1>
                <script>
                    // const bgTag = document.querySelector(".bg video");
                    // const bgSrcTag = bgTag.querySelector("source[src]").getAttribute('src');
                    const ad_ID = document.querySelector('.bg h1').innerText;
                    // console.log(bgSrcTag);
                    // console.log(ad_ID);
                    // console.log(user_ID);

                    // callAPI(bgTag, ad_ID);
                    Timer(ad_ID, user_ID);
                </script>
            <% } %>
        </div>
        
    </body>
</html>